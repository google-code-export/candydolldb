#summary Guides for using the application.
#labels Phase-Support,Featured

= !HowTo's =

<wiki:toc max_depth="2" />

== Setup ==

To setup the application, proceed as follows:

  # [http://code.google.com/p/candydolldb/downloads/list Download] a public release of CandyDollDB, or check out a the most current release from [http://code.google.com/p/candydolldb/source/checkout SubVersion].
  # Place the application in a directory accessable through a webserver (e.g. `/var/www/candydolldb/` or `C:\xampp\htdocs\candydolldb`).
  # Make sure that the user running the webserver has sufficient read- and or writepermissions in the application's root- and cache directories. Don't forget read-permission for your CD-collection, too.
  # Check if the configuration-file (`config.php`) already exists. If it does, remove it.<br>All subsequent page-requests will be redirected to `setup.php`.
  # Enter all the required data, e.g. database connection data, user account data, SMTP connection data.<br>If all goes well, you should then be prompted to log in.

Meanwhile, the file `config.php` has been written to your installation directory.<br>It contains all the settings you provided, and a few more.

Among those are the e-mailtemplate to use when a user forgot her/his password and the user-id of the first user to be setup; this will be used for commandline-authentication (see section [#Batch-imports Batch-imports]).

Once you are logged in, you can start importing models and sets:

  # Make sure you use the most up-to-date XML-file with all model- and setdata.<br>The XML-file can be downloaded from the [http://code.google.com/p/candydolldb/downloads/list Downloads]-page.
  # Navigate to 'Import XML' in the Features-menu and choose the downloaded file. Click 'Import XML' and wait a while.
  # Now you can import images and videos into their corresponding sets.<br>You can either
    * do it manually (great fun, if you've got some time to kill), or
    * do it automatically (see section [#Batch-imports Batch-imports]).

== Batch-imports ==

Because of the long duration of an all-images-all-videos-import, it is best to do this on the commandline of your server. In the next examples, the application is located in /var/www/candydolldb/ on a GNU/Linux system with PHP5.

Open a terminal and enter the following command to import all images:

{{{
$ php5 -f /var/www/candydolldb/import_image.php
}}}

For importing videos, use the following:

{{{
$ php5 -f /var/www/candydolldb/import_video.php
}}}

== Regular updates ==

  # Make sure you use the most up-to-date XML-file with all model- and setdata. The XML-file can be downloaded from the [http://code.google.com/p/candydolldb/downloads/list Downloads]-page and must be renamed to `setup_data.xml`. It contains the most complete list of models, their first- and lastnames, birthdates, sets and all releasedates.
  # Click the 'Process XML-data' button in the Features-menu.<br>This can take a while. Alternatively, you can import the data via the commandline:<br>
{{{
$ php5 -f /var/www/candydolldb/setup_data.php
}}}

== Validate a CandydollDB XML-file ==

To validate an XML-file for use in CandydollDB, one can use for example the [http://xmlsoft.org/ xmllint] utility on GNU/Linux.

{{{
$ xmllint --noout --schema /path/to/candydolldb-schema.xsd /path/to/xml-file.xml
}}}

This will either report success or failure.

== Recreate all model-, index- and set-cacheimages ==

When you want to refill your cache folder after, for example, deleting it by mistake, you can use GNU wget to do the trick almost automatically.

 # Hack the Authentication class (class.global.php) to always return a valid user.
 # Then call the following shell-command, where ./cddb/ is the folder where all files will be stored and http://localhost/candydolldb/ the URL of your CandyDollDB.
{{{
$ wget -erobots=off --mirror --page-requisites --accept *download_image.php*,*set.php* --reject *import* --directory-prefix=./cddb/ http://localhost/candydolldb/
}}}
 # Remove the folder where wget stored the files.
 # Unhack the Authentication class.